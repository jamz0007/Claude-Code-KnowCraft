---
argument-hint: [--today] [--stats] [--id=ID] [--quality=N] [--schedule] [--history]
description: 智能复习系统 - 基于遗忘曲线的间隔重复
allowed-tools: Read, Write, Edit, Bash
---

# /kb-review - 智能复习系统

## 功能
基于 SuperMemo 2 (SM-2) 算法的智能复习系统,根据记忆强度自动调整复习间隔,实现高效知识内化。

## 使用方式

### 查看今日复习任务
```
/kb-review --today

显示所有需要今天复习的知识条目
```

### 复习指定条目
```
/kb-review --id=2026-01-04-105815

显示该条目的详细内容,等待复习评分
```

### 提交复习评分
```
/kb-review --id=2026-01-04-105815 --quality=5

评分后自动计算下次复习时间
```

### 查看复习统计
```
/kb-review --stats

显示复习数据和遗忘曲线
```

### 查看复习历史
```
/kb-review --history

显示所有复习记录
```

### 查看复习计划
```
/kb-review --schedule

显示未来复习计划
```

## 参数说明

- `--today`: 显示今日需要复习的条目
- `--id=ID`: 指定要复习的条目 ID
- `--quality=N`: 复习质量评分 (1-5)
- `--stats`: 显示复习统计和遗忘曲线
- `--schedule`: 显示未来复习计划
- `--history`: 显示复习历史记录
- `--week`: 查看本周复习任务
- `--month`: 查看本月复习任务
- `--overdue`: 仅显示逾期未复习的条目

## SM-2 算法说明

### 质量评分标准

复习时需要自我评估记忆质量:

- **5 分**: 完全记住,毫不费力
  - 响应时间: < 2 秒
  - 记忆强度: 非常清晰
  - 下次间隔: 大幅增加

- **4 分**: 稍微思考后记起
  - 响应时间: 2-5 秒
  - 记忆强度: 清晰
  - 下次间隔: 正常增加

- **3 分**: 记得部分内容
  - 响应时间: 5-10 秒
  - 记忆强度: 模糊
  - 下次间隔: 保持不变

- **2 分**: 勉强记起
  - 响应时间: > 10 秒
  - 记忆强度: 非常模糊
  - 下次间隔: 减半

- **1 分**: 完全忘记
  - 响应时间: 无法回忆
  - 记忆强度: 无记忆
  - 下次间隔: 重置为 1 天

### SM-2 算法公式

```
1. 计算新的易学因子 (EF):
   EF' = EF + (0.1 - (5 - q) * (0.08 + (5 - q) * 0.02))

   其中:
   - EF: 当前易学因子 (初始值 2.5)
   - q: 质量评分 (1-5)

2. 如果 q < 3,则:
   - 重复次数重置为 1
   - 间隔重置为 1 天

3. 如果 q ≥ 3,则:
   - 重复次数 +1
   - 计算新间隔:
     * 第 1 次复习: I = 1 天
     * 第 2 次复习: I = 6 天
     * 第 3+ 次复习: I = I_prev * EF

4. 更新下次复习日期:
   nextReview = today + I
```

### 复习间隔示例

```
初始状态:
  - 易学因子 (EF): 2.5
  - 复习次数: 0
  - 间隔: 0 天

第 1 次复习 (质量 5):
  - EF: 2.5 → 2.6
  - 间隔: 1 天
  - 下次复习: 明天

第 2 次复习 (质量 5):
  - EF: 2.6 → 2.7
  - 间隔: 6 天
  - 下次复习: 1 周后

第 3 次复习 (质量 4):
  - EF: 2.7 → 2.6
  - 间隔: 6 * 2.6 ≈ 16 天
  - 下次复习: 16 天后

第 4 次复习 (质量 5):
  - EF: 2.6 → 2.7
  - 间隔: 16 * 2.7 ≈ 43 天
  - 下次复习: 43 天后 (约 1.5 个月)
```

## 输出示例

### 今日复习任务
```
/kb-review --today

📚 今日复习任务 (2026-01-04)

今日需复习: 5 个条目
预计用时: 25 分钟

┌─────────────────────────────────────────────────────────┐
│ 1. React Hooks 深入理解                                  │
│    ID: 2026-01-04-105815                                 │
│    上次复习: 3 天前                                       │
│    当前间隔: 7 天                                         │
│    易学因子: 2.5                                         │
│    复习次数: 2 次                                        │
│    标签: react, hooks, frontend                          │
├─────────────────────────────────────────────────────────┤
│ 2. JavaScript 闭包                                       │
│    ID: 2026-01-02-101200                                 │
│    上次复习: 7 天前                                       │
│    当前间隔: 16 天                                        │
│    易学因子: 2.6                                         │
│    复习次数: 3 次                                        │
│    标签: javascript, closure                             │
├─────────────────────────────────────────────────────────┤
│ 3. CSS Flexbox 布局                                      │
│    ID: 2025-12-28-091500                                 │
│    上次复习: 16 天前                                      │
│    当前间隔: 43 天                                        │
│    易学因子: 2.7                                         │
│    复习次数: 4 次                                        │
│    标签: css, layout                                     │
└─────────────────────────────────────────────────────────┘

⚠️ 逾期未复习: 2 个
  - Python 装饰器 (逾期 5 天)
  - Git 工作流 (逾期 12 天)

💡 复习建议:
  - 优先复习逾期条目
  - 高质量条目可快速浏览
  - 困难条目重点复习

下一步:
  /kb-review --id=2026-01-04-105815  # 开始复习第一个条目
```

### 复习单个条目
```
/kb-review --id=2026-01-04-105815

📖 正在复习: React Hooks 深入理解

─────────────────────────────────────────────────────────
上次复习: 2026-01-01 (3 天前)
复习次数: 2 次
当前间隔: 7 天
易学因子: 2.5
─────────────────────────────────────────────────────────

# React Hooks 深入理解

React Hooks 是 React 16.8 引入的新特性...

[显示完整内容...]

─────────────────────────────────────────────────────────
✋ 请回忆以上内容,然后评分:

评分标准:
  5 - 完全记住,毫不费力 (< 2秒)
  4 - 稍微思考后记起 (2-5秒)
  3 - 记得部分内容 (5-10秒)
  2 - 勉强记起 (> 10秒)
  1 - 完全忘记

提交评分:
  /kb-review --id=2026-01-04-105815 --quality=5
```

### 提交评分
```
/kb-review --id=2026-01-04-105815 --quality=5

✅ 复习完成!

条目: React Hooks 深入理解
评分: 5/5 (完全记住)

更新结果:
  复习次数: 2 → 3
  上次间隔: 7 天
  新间隔: 18 天 (7 × 2.5)
  易学因子: 2.5 → 2.6
  下次复习: 2026-01-22

本次复习效果: ⭐⭐⭐⭐⭐ 优秀

记忆趋势:
  第 1 次: 1 天间隔 → 质量评分: 5
  第 2 次: 7 天间隔 → 质量评分: 4
  第 3 次: 18 天间隔 → 质量评分: 5 ⬅️ 当前

下次复习日期: 2026-01-22 (18 天后)

继续复习下一个条目:
  /kb-review --today  # 查看剩余任务
```

### 复习统计
```
/kb-review --stats

📊 复习统计报告

总体数据:
  总条目: 45 个
  已复习: 38 个
  未复习: 7 个
  总复习次数: 127 次

平均数据:
  平均质量: 4.2/5.0 ⭐⭐⭐⭐
  平均易学因子: 2.6
  平均复习次数: 2.8 次
  平均间隔: 12.3 天

今日数据:
  已复习: 3 个
  待复习: 5 个
  今日平均质量: 4.3/5.0

本周数据:
  计划复习: 18 个
  已完成: 12 个
  完成率: 66.7%

记忆强度分布:
  ⭐⭐⭐⭐⭐ (5.0 EF): 8 个 (21%)
  ⭐⭐⭐⭐☆ (4.0-4.9 EF): 15 个 (39%)
  ⭐⭐⭐☆☆ (3.0-3.9 EF): 10 个 (26%)
  ⭐⭐☆☆☆ (2.0-2.9 EF): 5 个 (13%)
  ⭐☆☆☆☆ (< 2.0 EF): 0 个 (0%)

复习连续天数: 15 天 🔥

遗忘曲线:
  ┌─────────────────────────────────┐
  │ 100% ──●                         │
  │  90%    └─●                      │
  │  80%       └─●                   │
  │  70%          └─●                │
  │  60%             └─●             │
  │  50%                └─●          │
  │  40%                   └─●       │
  │  30%                      └─●    │
  │  20%                         └─● │
  │  10%                            └─●
  │   0%  1d  6d  16d 43d  3m  6m   │
  └─────────────────────────────────┘

保持率趋势:
  - 1 天后: 95%
  - 7 天后: 82%
  - 30 天后: 68%
  - 90 天后: 54%

需要加强复习的条目 (EF < 2.5):
  - React 状态管理 (EF: 2.1, 复习次数: 1)
  - TypeScript 泛型 (EF: 2.3, 复习次数: 2)

建议:
  - 保持每日复习习惯
  - 优先复习 EF 较低的条目
  - 定期复习旧知识 (90 天以上)
```

### 复习历史
```
/kb-review --history

📜 复习历史记录

最近 20 次复习:

┌────────────────────────────────────────────────────┐
│ 2026-01-04 14:30  React Hooks 深入理解    Q:5 ⭐⭐⭐⭐⭐ │
│ 2026-01-04 14:15  JavaScript 闭包          Q:4 ⭐⭐⭐⭐ │
│ 2026-01-04 13:50  CSS Flexbox 布局         Q:5 ⭐⭐⭐⭐⭐ │
│ 2026-01-03 20:10  Vue 组件通信             Q:3 ⭐⭐⭐   │
│ 2026-01-03 19:45  Python 装饰器            Q:4 ⭐⭐⭐⭐ │
│ 2026-01-03 10:20  Git 合并冲突             Q:5 ⭐⭐⭐⭐⭐ │
│ 2026-01-02 16:30  React 状态管理           Q:2 ⭐⭐     │
│ 2026-01-02 15:00  TypeScript 类型          Q:4 ⭐⭐⭐⭐ │
│ ...                                              │
└────────────────────────────────────────────────────┘

按条目统计:

React Hooks 深入理解:
  复习次数: 3 次
  平均质量: 4.7/5.0 ⭐⭐⭐⭐⭐
  间隔演化: 1d → 7d → 18d
  最后复习: 2026-01-04

JavaScript 闭包:
  复习次数: 4 次
  平均质量: 4.5/5.0 ⭐⭐⭐⭐
  间隔演化: 1d → 6d → 16d → 43d
  最后复习: 2026-01-04

... (显示所有条目)
```

### 未来复习计划
```
/kb-review --schedule

📅 未来复习计划

今日 (2026-01-04):
  - 5 个条目待复习

明日 (2026-01-05):
  - React 组件生命周期 (1 个)

本周 (1月4日-10日):
  - 1月5日: 1 个
  - 1月6日: 0 个
  - 1月7日: 2 个
  - 1月8日: 1 个
  - 1月9日: 0 个
  - 1月10日: 3 个
  合计: 12 个

本月 (1月):
  - 计划复习: 45 个
  - 已完成: 12 个
  - 待完成: 33 个

未来 3 个月概览:
  - 1月: 45 个条目
  - 2月: 38 个条目
  - 3月: 52 个条目

下次复习高峰:
  2026-01-22 (18 个条目)
  原因: 多个条目将在同一天达到复习周期

建议:
  - 平衡每日复习量
  - 提前或延后部分条目的复习
  - 避免单日复习过多
```

## 知识条目扩展字段

复习系统会在知识条目中添加以下字段:

```yaml
---
id: 2026-01-04-105815
title: "React Hooks 深入理解"
# ... 其他元数据

# 复习相关字段
learning:
  status: learning | reviewing | mastered

  # 复习数据
  reviews:
    - { date: "2026-01-01", quality: 5, interval: 1, ef: 2.5 }
    - { date: "2026-01-04", quality: 4, interval: 7, ef: 2.6 }

  # 下次复习
  nextReview: "2026-01-11"

  # 复习统计
  reviewCount: 2
  easeFactor: 2.6
  interval: 7  # 当前间隔(天)

  # 学习状态
  added: "2026-01-01"
  firstReview: "2026-01-01"
  lastReview: "2026-01-04"

  # 掌握度 (基于 EF 和复习次数)
  mastery: 0.35  # 35% 掌握度
---
```

### 掌握度计算

```
掌握度 = min(100%, (reviewCount * 10) + (EF * 20))

示例:
  - 复习 1 次, EF 2.5: 10 + 50 = 60%
  - 复习 3 次, EF 2.6: 30 + 52 = 82%
  - 复习 5 次, EF 2.8: 50 + 56 = 100%

状态分类:
  - learning: 掌握度 < 60%
  - reviewing: 60% ≤ 掌握度 < 90%
  - mastered: 掌握度 ≥ 90%
```

## 学习数据更新

复习系统会自动更新 `knowledge/learning.json`:

```json
{
  "version": "1.0",
  "lastUpdated": "2026-01-04T14:30:00Z",

  "stats": {
    "totalItems": 45,
    "itemsLearned": 38,
    "itemsMastered": 12,

    "totalReviews": 127,
    "averageQuality": 4.2,
    "averageEaseFactor": 2.6,

    "reviewRate": 0.85,
    "avgRetention": 0.78,

    "streak": 15
  },

  "today": {
    "date": "2026-01-04",
    "dueCount": 5,
    "completedCount": 3,
    "averageQuality": 4.3
  },

  "schedule": [
    {
      "itemId": "2026-01-04-105815",
      "nextReview": "2026-01-11",
      "interval": 7,
      "easeFactor": 2.6
    }
  ]
}
```

## 高级功能

### 批量复习
```
/kb-review --today --batch

自动按顺序复习所有到期条目,交互式评分
```

### 调整复习计划
```
/kb-review --id=ID --reschedule --days=3

将下次复习延后 3 天
```

### 重置复习进度
```
/kb-review --id=ID --reset

重置该条目的复习进度,间隔重置为 1 天
```

### 暂停复习
```
/kb-review --id=ID --pause

暂停该条目的复习提醒
```

### 导出复习数据
```
/kb-review --export --format=csv

导出复习记录为 CSV 文件
```

## 复习最佳实践

### 1. 每日坚持
```
最佳复习时间:
  - 早晨: 刷新记忆
  - 晚上: 巩固当天学习

建议时长:
  - 每日 15-30 分钟
  - 复习 5-10 个条目
```

### 2. 诚实评分
```
评分标准:
  - 不要过度自信
  - 基于实际回忆速度
  - 考虑记忆清晰度

常见错误:
  - 总是给 5 分
  - 忽略响应时间
  - 高估记忆质量
```

### 3. 主动回忆
```
复习流程:
  1. 先不看内容,尝试回忆
  2. 评分后查看详细内容
  3. 对比回忆与实际内容
  4. 标记记忆盲点
  5. 加强薄弱部分
```

### 4. 灵活调整
```
特殊情况:
  - 内容简单: 可提前复习
  - 内容困难: 可增加频率
  - 实际应用: 可延长间隔

调整命令:
  /kb-review --id=ID --reschedule --days=N
```

### 5. 定期回顾
```
每周回顾:
  /kb-review --stats  # 查看本周数据

每月回顾:
  /kb-review --history  # 分析复习历史

优化策略:
  - 识别困难条目
  - 调整复习频率
  - 优化学习计划
```

## 与其他命令配合

### 学习 + 复习
```
/kb-learn "React Hooks"      # 创建学习计划
/kb-review --today           # 每日复习
```

### 复习 + 测试
```
/kb-review --today           # 复习今日条目
/kb-quiz "reviewed"          # 测试复习效果
```

### 复习 + 费曼技巧
```
/kb-review --id=ID           # 复习条目
/kb-teach ID --role=teacher  # 用费曼技巧验证
```

## 注意事项

### 1. 评分准确性
- 诚实评估记忆质量
- 考虑回忆速度
- 不要随意给高分

### 2. 复习连续性
- 每天坚持复习
- 避免长时间中断
- 保持复习节奏

### 3. 质量优先
- 理解优于速度
- 深度优于广度
- 应用优于记忆

### 4. 个性化调整
- 根据个人记忆特点调整
- 不同内容不同策略
- 灵活运用系统

### 5. 长期坚持
- 至少坚持 3 个月
- 形成复习习惯
- 积累长期数据

## 扩展功能(未来)

### 1. 智能提醒
```
每日自动提醒到期复习
```

### 2. 学习建议
```
基于复习数据给出个性化建议
```

### 3. 图表可视化
```
生成交互式遗忘曲线图表
```

### 4. 社交功能
```
与朋友分享复习进度
```

### 5. AI 调优
```
AI 自动优化复习间隔
```
